const express = require('express')
const logger = require('morgan')
const path = require('path')
const server = express()
server.use(express.urlencoded({'extended': true}))
server.use(logger('dev'))

// Routes
server.get('/do_a_random', (req, res) => {
  res.send(`Your number is: ${Math.floor(Math.random() * 100) + 1}`)
})

server.post('/cs212/homework/8/', (req, res) => {
  response_str = (`Star Wars is a ${req.body.adj1} ${req.body.noun1} of ${req.body.adj2}\n
                    versus evil in a ${req.body.noun2} far far away\n
                    There are ${req.body.adj3} battles between\n
                    ${req.body.adj4} ${req.body.noun3} in ${req.body.adj5}\n
                    space and ${req.body.adj6} duels with ${req.body.noun4}\n
                    called ${req.body.adj7} saders. ${req.body.noun5}\n
                    called "droids" are helpers and ${req.body.noun6}\n
                    to the hereos. A ${req.body.adj8} power called\n
                    The ${req.body.noun7} ${req.body.verb1}s people to do ${req.body.adj9}\n
                    things, like ${req.body.verb2} ${req.body.noun8}. The Jedi\n
                    ${req.body.noun9} use The Force for the\n
                    ${req.body.adj10} side and the Sith ${req.body.verb3} it for\n
                    the ${req.body.adj11} side.`)
  res.send(response_str)
})

// Setup static page serving for all the pages in "public"
const publicServedFilesPath = path.join(__dirname, 'public')
server.use(express.static(publicServedFilesPath))


// The server uses port 80 by default unless you start it with the extra
// command line argument 'local' like this:
//       node server.js local
let port = 80
if (process.argv[2] === 'local') {
  port = 8080
}

server.listen(port, () => console.log('Ready on localhost!'))
